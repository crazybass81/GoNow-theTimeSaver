# Phase 3 통합 테스트 가이드 / Integration Test Guide

**작성일**: 2026-01-07
**대상**: Phase 3 - 위젯 & 알림 통합 테스트

---

## 📋 테스트 개요 / Test Overview

Phase 3에서 구현한 Android/iOS 위젯과 알림 시스템의 통합 테스트 가이드입니다.

**테스트 범위**:
- ✅ Flutter ↔ Android 네이티브 통신
- ✅ Flutter ↔ iOS 네이티브 통신
- ✅ 위젯 UI 표시 및 업데이트
- ✅ 알림 스케줄링 및 수신
- ✅ 시간대별 색상 변경
- ✅ 배터리 소모 테스트

---

## 🧪 테스트 환경 설정 / Test Environment Setup

### 필수 요구사항
- Android 디바이스/에뮬레이터 (Android 6.0+ / API 23+)
- iOS 디바이스/시뮬레이터 (iOS 14.0+)
- Flutter 앱 빌드 및 설치 완료
- 위젯 추가 완료

### 테스트 데이터 준비
```dart
// 테스트용 일정 데이터
Trip testTrip = Trip(
  id: 'test-001',
  title: '통합 테스트 일정',
  destination: '테스트 목적지',
  departureTime: DateTime.now().add(Duration(minutes: 45)),
  arrivalTime: DateTime.now().add(Duration(minutes: 90)),
  transportType: TransportType.car,
);
```

---

## ✅ 기능 테스트 / Functional Tests

### 1. 위젯 기본 표시 테스트

#### 테스트 1.1: 빈 상태 위젯
**목적**: 일정이 없을 때 빈 위젯 표시 확인

**Android 테스트**:
1. 홈 화면에 GoNow 위젯 추가
2. 앱 실행 전 위젯 확인

**예상 결과**:
```
┌─────────────────────┐
│      📅             │
│  일정이 없습니다       │
│  새 일정을 추가하세요  │
└─────────────────────┘
```

**iOS 테스트**:
1. 홈 화면 편집 모드 진입
2. GoNow 위젯 추가
3. 초기 상태 확인

**예상 결과**: Android와 동일

**✅ Pass 조건**:
- [ ] 위젯이 정상적으로 표시됨
- [ ] "일정이 없습니다" 메시지 표시
- [ ] 배경색이 회색(#F5F5F5)

---

#### 테스트 1.2: 일정 표시 위젯
**목적**: 일정이 있을 때 위젯 정보 표시 확인

**테스트 절차**:
1. 앱 실행
2. 새 일정 추가 (45분 후 출발)
3. 홈 화면으로 이동
4. 위젯 확인 (약 5초 대기)

**예상 결과**:
```
┌──────────────────────────┐
│  통합 테스트 일정          │
│  45분                    │
│  🚗 출발: 14:30          │
│  ✅ 여유있어요            │
└──────────────────────────┘
```

**✅ Pass 조건**:
- [ ] 일정 제목 표시
- [ ] 남은 시간 표시 (45분)
- [ ] 출발 시간 표시
- [ ] 배경색 초록색 (#4CAF50)
- [ ] 상태 메시지 "✅ 여유있어요"

---

### 2. 시간대별 색상 변경 테스트

#### 테스트 2.1: 초록색 단계 (30분 이상)
**목적**: 여유 시간 상태 확인

**테스트 절차**:
1. 45분 후 출발 일정 추가
2. 위젯 확인

**예상 결과**:
- 배경색: 초록색 (#4CAF50)
- 상태: "✅ 여유있어요"
- 업데이트 주기: 15분

**✅ Pass 조건**:
- [ ] 배경색 초록색
- [ ] 상태 메시지 정확
- [ ] 남은 시간 정확

---

#### 테스트 2.2: 주황색 단계 (15-30분)
**목적**: 준비 필요 상태 확인

**테스트 절차**:
1. 25분 후 출발 일정 추가
2. 위젯 확인

**예상 결과**:
- 배경색: 주황색 (#FF9800)
- 상태: "⚠️ 준비하세요"
- 업데이트 주기: 5분

**✅ Pass 조건**:
- [ ] 배경색 주황색
- [ ] 상태 메시지 정확
- [ ] 남은 시간 정확

---

#### 테스트 2.3: 빨간색 단계 (0-15분)
**목적**: 긴급 상태 확인

**테스트 절차**:
1. 10분 후 출발 일정 추가
2. 위젯 확인

**예상 결과**:
- 배경색: 빨간색 (#F44336)
- 상태: "🚨 지금 출발!"
- 업데이트 주기: 3분

**✅ Pass 조건**:
- [ ] 배경색 빨간색
- [ ] 상태 메시지 정확
- [ ] 남은 시간 정확

---

#### 테스트 2.4: 진한 빨간색 단계 (지각)
**목적**: 지각 상태 확인

**테스트 절차**:
1. 이미 지난 출발 시간으로 일정 추가
2. 위젯 확인

**예상 결과**:
- 배경색: 진한 빨간색 (#B71C1C)
- 상태: "❌ 지각 위험!"
- 남은 시간: "지각!"

**✅ Pass 조건**:
- [ ] 배경색 진한 빨간색
- [ ] 상태 메시지 정확
- [ ] 남은 시간 "지각!" 표시

---

### 3. 위젯 업데이트 테스트

#### 테스트 3.1: 실시간 업데이트
**목적**: 위젯이 자동으로 업데이트되는지 확인

**Android 테스트 절차**:
1. 45분 후 출발 일정 추가 (초록색)
2. 홈 화면에서 15분 대기
3. 위젯 확인 (30분 남음, 주황색으로 변경되어야 함)

**iOS 테스트 절차**:
1. 45분 후 출발 일정 추가
2. 앱 종료
3. 홈 화면에서 15분 대기
4. 위젯 확인

**예상 결과**:
- 15분 후: 30분 남음, 주황색 (#FF9800)
- 20분 후: 25분 남음, 주황색 유지
- 30분 후: 15분 남음, 빨간색 (#F44336)

**✅ Pass 조건**:
- [ ] 시간이 자동으로 감소함
- [ ] 색상이 자동으로 변경됨
- [ ] 상태 메시지가 업데이트됨

---

#### 테스트 3.2: 수동 갱신
**목적**: 앱 실행 시 위젯 즉시 업데이트 확인

**테스트 절차**:
1. 일정 추가
2. 앱 종료
3. 5분 대기
4. 앱 다시 실행
5. 홈 화면으로 즉시 이동
6. 위젯 확인 (5분이 감소되어 있어야 함)

**예상 결과**:
- 위젯 데이터가 즉시 업데이트됨
- 남은 시간이 정확함

**✅ Pass 조건**:
- [ ] 앱 실행 후 위젯 즉시 갱신
- [ ] 남은 시간 정확
- [ ] 색상 단계 정확

---

### 4. 알림 테스트

#### 테스트 4.1: 30분 전 알림
**목적**: 30분 전 일반 알림 수신 확인

**테스트 절차**:
1. 현재 시간 + 31분으로 일정 추가
2. 알림 권한 허용 확인
3. 1분 대기
4. 알림 수신 확인

**예상 결과**:
```
제목: [일정 제목] - 30분 전 알림
내용: [출발 시간]까지 출발하세요. 준비 시작!
```

**✅ Pass 조건**:
- [ ] 정확히 30분 전에 알림 수신
- [ ] 알림 제목 정확
- [ ] 알림 내용 정확
- [ ] 알림 클릭 시 앱 열림

---

#### 테스트 4.2: 10분 전 긴급 알림
**목적**: 10분 전 긴급 알림 수신 확인

**Android 테스트 절차**:
1. 현재 시간 + 11분으로 일정 추가
2. 1분 대기
3. 알림 수신 확인

**예상 결과**:
```
제목: 🚨 [일정 제목] - 긴급 알림!
내용: 10분 후 출발! 지금 나가세요!
```

**Android 추가 확인**:
- 알림 채널: "Urgent Reminders"
- 중요도: Max
- LED 라이트: 켜짐
- 진동: 있음

**iOS 테스트 절차**:
1. 현재 시간 + 11분으로 일정 추가
2. 1분 대기
3. 알림 수신 확인

**iOS 추가 확인**:
- Interruption Level: timeSensitive
- Sound: default

**✅ Pass 조건**:
- [ ] 정확히 10분 전에 알림 수신
- [ ] 알림 제목에 🚨 포함
- [ ] 긴급 알림 스타일 적용
- [ ] 소리 및 진동 작동

---

#### 테스트 4.3: 동적 알림
**목적**: 교통 상황 변화 시 동적 알림 확인

**테스트 시나리오**:
1. 일정 추가
2. 교통 지연 시뮬레이션 (TripProvider에서 수동 트리거)
3. 동적 알림 수신 확인

**예상 결과**:
```
제목: [커스텀 제목]
내용: [커스텀 내용]
```

**✅ Pass 조건**:
- [ ] 동적 알림 수신
- [ ] 커스텀 메시지 표시
- [ ] 적절한 우선순위 적용

---

### 5. 일정 완료/취소 테스트

#### 테스트 5.1: 일정 완료
**목적**: 일정 완료 시 위젯 및 알림 정리 확인

**테스트 절차**:
1. 일정 추가
2. 일정 완료 처리
3. 위젯 확인
4. 알림 확인

**예상 결과**:
- 위젯: 빈 상태로 변경
- 알림: 모든 예약된 알림 취소

**✅ Pass 조건**:
- [ ] 위젯이 빈 상태로 표시
- [ ] 알림이 취소됨
- [ ] 다음 일정이 있으면 표시

---

#### 테스트 5.2: 일정 취소
**목적**: 일정 취소 시 위젯 및 알림 정리 확인

**테스트 절차**:
1. 일정 추가
2. 일정 삭제
3. 위젯 확인
4. 알림 확인

**예상 결과**:
- 위젯: 빈 상태로 변경
- 알림: 모든 예약된 알림 취소

**✅ Pass 조건**:
- [ ] 위젯이 빈 상태로 표시
- [ ] 알림이 취소됨

---

## 🔋 성능 및 배터리 테스트

### 배터리 소모 테스트

#### 테스트 절차:
1. 디바이스 배터리 100% 충전
2. 앱에 일정 추가 (2시간 후 출발)
3. 앱 종료
4. 1시간 대기
5. 배터리 소모량 확인

**Android 확인**:
```bash
# 배터리 사용량 확인
adb shell dumpsys batterystats | grep -A 10 "com.gonow.gotimesaver"
```

**iOS 확인**:
- 설정 → 배터리 → 앱별 배터리 사용량

**✅ Pass 조건**:
- [ ] 1시간당 배터리 소모 < 2%
- [ ] WorkManager/Timeline 정상 작동
- [ ] 메모리 누수 없음

---

### 메모리 사용량 테스트

**Android 테스트**:
```bash
# 메모리 사용량 확인
adb shell dumpsys meminfo com.gonow.gotimesaver
```

**iOS 테스트**:
- Xcode → Debug Navigator → Memory

**✅ Pass 조건**:
- [ ] 메모리 사용량 < 50MB
- [ ] 메모리 누수 없음
- [ ] 위젯 업데이트 시 메모리 급증 없음

---

## 🐛 엣지 케이스 테스트

### 엣지 케이스 1: 네트워크 없음
**시나리오**: 오프라인 상태에서 위젯 작동

**테스트 절차**:
1. 일정 추가
2. 비행기 모드 활성화
3. 위젯 확인
4. 알림 수신 확인

**예상 결과**:
- 위젯 표시 정상 (로컬 데이터)
- 알림 스케줄링 정상

---

### 엣지 케이스 2: 앱 강제 종료
**시나리오**: 앱 강제 종료 후 위젯 작동

**Android 테스트**:
```bash
# 앱 강제 종료
adb shell am force-stop com.gonow.gotimesaver
```

**iOS 테스트**:
- 앱 스위처에서 스와이프 제거

**테스트 절차**:
1. 일정 추가
2. 앱 강제 종료
3. 위젯 확인 (15분 대기)

**예상 결과**:
- 위젯 계속 업데이트됨
- 알림 정상 수신

---

### 엣지 케이스 3: 시스템 재부팅
**시나리오**: 디바이스 재부팅 후 위젯 작동

**테스트 절차**:
1. 일정 추가
2. 디바이스 재부팅
3. 위젯 확인
4. 알림 확인

**예상 결과**:
- 위젯 데이터 유지됨
- 알림 스케줄 유지됨

---

### 엣지 케이스 4: 다수의 일정
**시나리오**: 여러 일정이 있을 때 위젯 표시

**테스트 절차**:
1. 3개의 일정 추가:
   - 30분 후
   - 1시간 후
   - 2시간 후
2. 위젯 확인

**예상 결과**:
- 가장 가까운 일정 표시 (30분 후)
- 알림은 각 일정마다 스케줄링됨

---

## 📊 테스트 리포트 템플릿

### 기본 정보
- **테스트 일자**: [날짜]
- **테스터**: [이름]
- **플랫폼**: Android / iOS
- **디바이스**: [모델명]
- **OS 버전**: [버전]
- **앱 버전**: [버전]

### 테스트 결과
| 테스트 항목 | 예상 결과 | 실제 결과 | Pass/Fail | 비고 |
|------------|----------|----------|-----------|------|
| 빈 위젯 표시 | 빈 상태 UI | | | |
| 일정 표시 | 일정 정보 표시 | | | |
| 초록색 단계 | 초록색 배경 | | | |
| 주황색 단계 | 주황색 배경 | | | |
| 빨간색 단계 | 빨간색 배경 | | | |
| 진한빨강 단계 | 진한빨강 배경 | | | |
| 실시간 업데이트 | 자동 갱신 | | | |
| 30분 알림 | 알림 수신 | | | |
| 10분 알림 | 긴급 알림 | | | |
| 일정 완료 | 위젯 정리 | | | |
| 배터리 소모 | < 2%/hour | | | |

### 발견된 이슈
1. [이슈 제목]
   - **재현 절차**: [절차]
   - **예상 결과**: [예상]
   - **실제 결과**: [실제]
   - **심각도**: High / Medium / Low

---

## ✅ 최종 체크리스트

### Android
- [ ] 위젯 추가 가능
- [ ] 위젯 표시 정상
- [ ] 모든 색상 단계 작동
- [ ] 실시간 업데이트 작동
- [ ] 30분 알림 수신
- [ ] 10분 알림 수신
- [ ] 일정 완료 시 위젯 정리
- [ ] 배터리 소모 정상 범위
- [ ] 메모리 사용량 정상 범위
- [ ] 오프라인 작동
- [ ] 앱 강제 종료 후 작동
- [ ] 재부팅 후 작동

### iOS
- [ ] 위젯 추가 가능
- [ ] 위젯 표시 정상
- [ ] 모든 색상 단계 작동
- [ ] 실시간 업데이트 작동
- [ ] 30분 알림 수신
- [ ] 10분 알림 수신
- [ ] 일정 완료 시 위젯 정리
- [ ] 배터리 소모 정상 범위
- [ ] 메모리 사용량 정상 범위
- [ ] 오프라인 작동
- [ ] 앱 강제 종료 후 작동
- [ ] 재부팅 후 작동

---

**작성 완료**: 2026-01-07
**예상 테스트 소요 시간**: 2-3시간
**다음 단계**: 버그 수정 및 최적화
